<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration - ChargingHub Optimization</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-2 sidebar">
                <div class="sidebar-header">
                    <h3>ChargingHub Optimization</h3>
                </div>
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('dashboard') }}">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('configuration') }}">Configuration</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('map_page') }}">Maps</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logs') }}">Logs</a>
                    </li>
                </ul>
            </div>
            
            <!-- Main content -->
            <div class="col-md-10 main-content">
                <div class="row mb-4">
                    <div class="col">
                        <h1>Configuration</h1>
                        <p>Configure parameters for the charging hub optimization process.</p>
                    </div>
                    <div class="col text-end">
                        <button id="saveConfig" class="btn btn-primary">Save Configuration</button>
                        <div class="btn-group">
                            <button id="runOptimization" class="btn btn-success">Run All</button>
                            <button class="btn btn-success dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
                                <span class="visually-hidden">Toggle Dropdown</span>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#" id="runTraffic">Run Traffic Calculation</a></li>
                                <li><a class="dropdown-item" href="#" id="runChargingHub">Run Charging Hub Setup</a></li>
                                <li><a class="dropdown-item" href="#" id="runGridOpt">Run Grid Optimization</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-header">
                                <h5>Configuration Settings</h5>
                            </div>
                            <div class="card-body">
                                <!-- Configuration form with tabs -->
                                <ul class="nav nav-tabs" id="configTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="execution-tab" data-bs-toggle="tab" data-bs-target="#execution" type="button" role="tab" aria-controls="execution" aria-selected="true">Execution</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="charging-tab" data-bs-toggle="tab" data-bs-target="#charging" type="button" role="tab" aria-controls="charging" aria-selected="false">Charging</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="location-tab" data-bs-toggle="tab" data-bs-target="#location" type="button" role="tab" aria-controls="location" aria-selected="false">Location</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="battery-tab" data-bs-toggle="tab" data-bs-target="#battery" type="button" role="tab" aria-controls="battery" aria-selected="false">Battery</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="results-tab" data-bs-toggle="tab" data-bs-target="#results" type="button" role="tab" aria-controls="results" aria-selected="false">Results</button>
                                    </li>
                                </ul>
                                
                                <div class="tab-content p-3" id="configTabContent">
                                    <!-- Execution Flags Tab -->
                                    <div class="tab-pane fade show active" id="execution" role="tabpanel" aria-labelledby="execution-tab">
                                        <h4>Execution Flags</h4>
                                        <p>Control which parts of the optimization process are executed.</p>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <h5>Main Process Flags</h5>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RUN_TRAFFIC_CALCULATION" {% if execution_flags.RUN_TRAFFIC_CALCULATION %}checked{% endif %}>
                                                    <label class="form-check-label" for="RUN_TRAFFIC_CALCULATION">Run Traffic Calculation</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RUN_CHARGING_HUB_SETUP" {% if execution_flags.RUN_CHARGING_HUB_SETUP %}checked{% endif %}>
                                                    <label class="form-check-label" for="RUN_CHARGING_HUB_SETUP">Run Charging Hub Setup</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RUN_GRID_OPTIMIZATION" {% if execution_flags.RUN_GRID_OPTIMIZATION %}checked{% endif %}>
                                                    <label class="form-check-label" for="RUN_GRID_OPTIMIZATION">Run Grid Optimization</label>
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <h5>Traffic Calculation Flags</h5>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RECALCULATE_BREAKS" {% if execution_flags.RECALCULATE_BREAKS %}checked{% endif %}>
                                                    <label class="form-check-label" for="RECALCULATE_BREAKS">Recalculate Breaks</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RECALCULATE_TOLL_MIDPOINTS" {% if execution_flags.RECALCULATE_TOLL_MIDPOINTS %}checked{% endif %}>
                                                    <label class="form-check-label" for="RECALCULATE_TOLL_MIDPOINTS">Recalculate Toll Midpoints</label>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <h5>Charging Hub Setup Flags</h5>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RUN_TRUCK_MATCHING" {% if execution_flags.RUN_TRUCK_MATCHING %}checked{% endif %}>
                                                    <label class="form-check-label" for="RUN_TRUCK_MATCHING">Run Truck Matching</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RUN_HUB_CONFIGURATION" {% if execution_flags.RUN_HUB_CONFIGURATION %}checked{% endif %}>
                                                    <label class="form-check-label" for="RUN_HUB_CONFIGURATION">Run Hub Configuration</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="RUN_DEMAND_OPTIMIZATION" {% if execution_flags.RUN_DEMAND_OPTIMIZATION %}checked{% endif %}>
                                                    <label class="form-check-label" for="RUN_DEMAND_OPTIMIZATION">Run Demand Optimization</label>
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <h5>Grid Optimization Flags</h5>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="USE_DISTANCE_CALCULATION" {% if execution_flags.USE_DISTANCE_CALCULATION %}checked{% endif %}>
                                                    <label class="form-check-label" for="USE_DISTANCE_CALCULATION">Use Distance Calculation</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="CREATE_PLOT" {% if execution_flags.CREATE_PLOT %}checked{% endif %}>
                                                    <label class="form-check-label" for="CREATE_PLOT">Create Plot</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="CREATE_DISTANCE_MAPS" {% if execution_flags.CREATE_DISTANCE_MAPS %}checked{% endif %}>
                                                    <label class="form-check-label" for="CREATE_DISTANCE_MAPS">Create Distance Maps</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="INCLUDE_BATTERY" {% if execution_flags.INCLUDE_BATTERY %}checked{% endif %}>
                                                    <label class="form-check-label" for="INCLUDE_BATTERY">Include Battery</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="USE_MANUAL_CHARGER_COUNT" {% if execution_flags.USE_MANUAL_CHARGER_COUNT %}checked{% endif %}>
                                                    <label class="form-check-label" for="USE_MANUAL_CHARGER_COUNT">Use Manual Charger Count</label>
                                                </div>
                                                <div class="form-check form-switch mb-2">
                                                    <input class="form-check-input" type="checkbox" id="DEBUG_MODE" {% if execution_flags.DEBUG_MODE %}checked{% endif %}>
                                                    <label class="form-check-label" for="DEBUG_MODE">Debug Mode</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Charging Configuration Tab -->
                                    <div class="tab-pane fade" id="charging" role="tabpanel" aria-labelledby="charging-tab">
                                        <h4>Charging Configuration</h4>
                                        <p>Configure parameters for charging strategies and power settings.</p>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="STRATEGY" class="form-label">Charging Strategy</label>
                                                    <select class="form-select" id="STRATEGY" multiple>
                                                        <option value="T_min" {% if "T_min" in charging_config.STRATEGY %}selected{% endif %}>T_min</option>
                                                        <option value="Konstant" {% if "Konstant" in charging_config.STRATEGY %}selected{% endif %}>Konstant</option>
                                                        <option value="Hub" {% if "Hub" in charging_config.STRATEGY %}selected{% endif %}>Hub</option>
                                                    </select>
                                                    <div class="form-text">Hold Ctrl/Cmd to select multiple strategies</div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="ALL_STRATEGIES" class="form-label">All Available Strategies</label>
                                                    <select class="form-select" id="ALL_STRATEGIES" multiple>
                                                        <option value="T_min" {% if "T_min" in charging_config.ALL_STRATEGIES %}selected{% endif %}>T_min</option>
                                                        <option value="Konstant" {% if "Konstant" in charging_config.ALL_STRATEGIES %}selected{% endif %}>Konstant</option>
                                                        <option value="Hub" {% if "Hub" in charging_config.ALL_STRATEGIES %}selected{% endif %}>Hub</option>
                                                    </select>
                                                    <div class="form-text">Hold Ctrl/Cmd to select multiple strategies</div>
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="ladequote" class="form-label">Charging Quota (0-1)</label>
                                                    <input type="number" class="form-control" id="ladequote" value="{{ charging_config.ladequote }}" min="0" max="1" step="0.01">
                                                    <div class="form-text">Charging quota as percentage (0.8 = 80%)</div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="power" class="form-label">Power Scaling (NCS-HPC-MCS)</label>
                                                    <input type="text" class="form-control" id="power" value="{{ charging_config.power }}">
                                                    <div class="form-text">Format: NCS-HPC-MCS (Example: 100-100-100)</div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="pause" class="form-label">Pause Times (min)</label>
                                                    <input type="text" class="form-control" id="pause" value="{{ charging_config.pause }}">
                                                    <div class="form-text">Format: ShortPause-LongPause (Example: 45-540)</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Location Tab -->
                                    <div class="tab-pane fade" id="location" role="tabpanel" aria-labelledby="location-tab">
                                        <h4>Default Location</h4>
                                        <p>Set the default coordinates for optimization.</p>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="LONGITUDE" class="form-label">Longitude</label>
                                                    <input type="number" class="form-control" id="LONGITUDE" value="{{ default_location.LONGITUDE }}" step="0.000001">
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="LATITUDE" class="form-label">Latitude</label>
                                                    <input type="number" class="form-control" id="LATITUDE" value="{{ default_location.LATITUDE }}" step="0.000001">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col">
                                                <div id="location-map" style="width: 100%; height: 400px; border: 1px solid #ccc;">
                                                    <p class="text-center p-5">Map will be shown here</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Battery Tab -->
                                    <div class="tab-pane fade" id="battery" role="tabpanel" aria-labelledby="battery-tab">
                                        <h4>Battery Configuration</h4>
                                        <p>Configure parameters for battery storage.</p>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="COST_PER_KWH" class="form-label">Cost per kWh (€)</label>
                                                    <input type="number" class="form-control" id="COST_PER_KWH" value="{{ battery_config.COST_PER_KWH }}" min="0" step="1">
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="COST_PER_KW" class="form-label">Cost per kW (€)</label>
                                                    <input type="number" class="form-control" id="COST_PER_KW" value="{{ battery_config.COST_PER_KW }}" min="0" step="1">
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="MAX_CAPACITY" class="form-label">Maximum Capacity (kWh)</label>
                                                    <input type="number" class="form-control" id="MAX_CAPACITY" value="{{ battery_config.MAX_CAPACITY }}" min="0" step="100">
                                                </div>
                                            </div>
                                            
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="EFFICIENCY" class="form-label">Round-trip Efficiency</label>
                                                    <input type="number" class="form-control" id="EFFICIENCY" value="{{ battery_config.EFFICIENCY }}" min="0" max="1" step="0.01">
                                                    <div class="form-text">Value between 0 and 1 (0.95 = 95%)</div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="MIN_SOC" class="form-label">Minimum State of Charge</label>
                                                    <input type="number" class="form-control" id="MIN_SOC" value="{{ battery_config.MIN_SOC }}" min="0" max="1" step="0.01">
                                                    <div class="form-text">Value between 0 and 1</div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="MAX_SOC" class="form-label">Maximum State of Charge</label>
                                                    <input type="number" class="form-control" id="MAX_SOC" value="{{ battery_config.MAX_SOC }}" min="0" max="1" step="0.01">
                                                    <div class="form-text">Value between 0 and 1</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Results Naming Tab -->
                                    <div class="tab-pane fade" id="results" role="tabpanel" aria-labelledby="results-tab">
                                        <h4>Results Configuration</h4>
                                        <p>Configure how results are named and saved.</p>
                                        
                                        <div class="row mb-3">
                                            <div class="col-md-6">
                                                <div class="form-check form-switch mb-3">
                                                    <input class="form-check-input" type="checkbox" id="USE_CUSTOM_ID" {% if result_naming.USE_CUSTOM_ID %}checked{% endif %}>
                                                    <label class="form-check-label" for="USE_CUSTOM_ID">Use Custom ID</label>
                                                    <div class="form-text">If enabled, uses a custom ID instead of a hash for result files</div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <label for="CUSTOM_ID" class="form-label">Custom ID</label>
                                                    <input type="text" class="form-control" id="CUSTOM_ID" value="{{ result_naming.CUSTOM_ID }}" {% if not result_naming.USE_CUSTOM_ID %}disabled{% endif %}>
                                                    <div class="form-text">Custom identifier for result files</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Process Output -->
                <div class="row mt-4">
                    <div class="col">
                        <div class="card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h5 id="process-title">Process Output</h5>
                                <button id="stopProcess" class="btn btn-danger btn-sm" style="display: none;">Stop Process</button>
                            </div>
                            <div class="card-body">
                                <pre id="process-output" class="process-output">No process running...</pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.socket.io/4.4.1/socket.io.min.js"></script>
    <script>
        // Initialize Socket.IO
        const socket = io();
        let currentProcessId = null;
        
        // Connect to the server
        socket.on('connect', () => {
            console.log('Connected to server');
        });
        
        // Process events
        socket.on('process_started', (data) => {
            console.log('Process started:', data);
            currentProcessId = data.id;
            $('#process-title').text(`Process Output (${data.id})`);
            $('#process-output').text('');
            $('#stopProcess').show();
        });
        
        socket.on('process_output', (data) => {
            console.log('Process output:', data);
            if (data.id === currentProcessId) {
                const output = $('#process-output');
                output.append(data.output + '\n');
                output.scrollTop(output[0].scrollHeight);
            }
        });
        
        socket.on('process_completed', (data) => {
            console.log('Process completed:', data);
            if (data.id === currentProcessId) {
                $('#process-output').append('\n' + (data.success ? 'Process completed successfully!' : 'Process completed with errors.') + '\n');
                $('#stopProcess').hide();
            }
        });
        
        // Document ready
        $(document).ready(function() {
            // Toggle custom ID input based on checkbox
            $('#USE_CUSTOM_ID').change(function() {
                if($(this).is(':checked')) {
                    $('#CUSTOM_ID').prop('disabled', false);
                } else {
                    $('#CUSTOM_ID').prop('disabled', true);
                }
            });
            
            // Save configuration
            $('#saveConfig').click(function() {
                // Collect data from form
                const config = {
                    EXECUTION_FLAGS: {},
                    CHARGING_CONFIG: {},
                    DEFAULT_LOCATION: {},
                    BATTERY_CONFIG: {},
                    RESULT_NAMING: {}
                };
                
                // Execution flags
                $('#execution input[type="checkbox"]').each(function() {
                    config.EXECUTION_FLAGS[this.id] = this.checked;
                });
                
                // Charging config
                config.CHARGING_CONFIG = {
                    STRATEGY: $('#STRATEGY').val(),
                    ALL_STRATEGIES: $('#ALL_STRATEGIES').val(),
                    ladequote: parseFloat($('#ladequote').val()),
                    power: $('#power').val(),
                    pause: $('#pause').val()
                };
                
                // Location
                config.DEFAULT_LOCATION = {
                    LONGITUDE: parseFloat($('#LONGITUDE').val()),
                    LATITUDE: parseFloat($('#LATITUDE').val())
                };
                
                // Battery config
                config.BATTERY_CONFIG = {
                    COST_PER_KWH: parseFloat($('#COST_PER_KWH').val()),
                    COST_PER_KW: parseFloat($('#COST_PER_KW').val()),
                    MAX_CAPACITY: parseFloat($('#MAX_CAPACITY').val()),
                    EFFICIENCY: parseFloat($('#EFFICIENCY').val()),
                    MIN_SOC: parseFloat($('#MIN_SOC').val()),
                    MAX_SOC: parseFloat($('#MAX_SOC').val())
                };
                
                // Result naming
                config.RESULT_NAMING = {
                    USE_CUSTOM_ID: $('#USE_CUSTOM_ID').is(':checked'),
                    CUSTOM_ID: $('#CUSTOM_ID').val()
                };
                
                // Send to server
                $.ajax({
                    url: '/api/config/save',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(config),
                    success: function(response) {
                        alert('Configuration saved successfully!');
                    },
                    error: function(error) {
                        console.error('Error saving configuration:', error);
                        alert('Error saving configuration: ' + (error.responseJSON?.error || 'Unknown error'));
                    }
                });
            });
            
            // Run optimization processes
            $('#runOptimization').click(function() {
                runProcess('/api/run/main');
            });
            
            $('#runTraffic').click(function() {
                runProcess('/api/run/traffic_calculation');
            });
            
            $('#runChargingHub').click(function() {
                runProcess('/api/run/charging_hub_setup');
            });
            
            $('#runGridOpt').click(function() {
                runProcess('/api/run/grid_optimization');
            });
            
            // Stop running process
            $('#stopProcess').click(function() {
                if (currentProcessId) {
                    $.ajax({
                        url: `/api/process/${currentProcessId}/stop`,
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({}),  // Send empty JSON object
                        success: function(response) {
                            $('#process-output').append('\nProcess stopped by user.\n');
                            $('#stopProcess').hide();
                        },
                        error: function(error) {
                            console.error('Error stopping process:', error);
                            alert('Error stopping process: ' + (error.responseJSON?.error || 'Unknown error'));
                        }
                    });
                }
            });
            
            // Helper function to run a process
            function runProcess(url) {
                // Save config first
                const config = {
                    EXECUTION_FLAGS: {},
                    CHARGING_CONFIG: {},
                    DEFAULT_LOCATION: {},
                    BATTERY_CONFIG: {},
                    RESULT_NAMING: {}
                };
                
                // Execution flags
                $('#execution input[type="checkbox"]').each(function() {
                    config.EXECUTION_FLAGS[this.id] = this.checked;
                });
                
                // Charging config
                config.CHARGING_CONFIG = {
                    STRATEGY: $('#STRATEGY').val(),
                    ALL_STRATEGIES: $('#ALL_STRATEGIES').val(),
                    ladequote: parseFloat($('#ladequote').val()),
                    power: $('#power').val(),
                    pause: $('#pause').val()
                };
                
                // Location
                config.DEFAULT_LOCATION = {
                    LONGITUDE: parseFloat($('#LONGITUDE').val()),
                    LATITUDE: parseFloat($('#LATITUDE').val())
                };
                
                // Battery config
                config.BATTERY_CONFIG = {
                    COST_PER_KWH: parseFloat($('#COST_PER_KWH').val()),
                    COST_PER_KW: parseFloat($('#COST_PER_KW').val()),
                    MAX_CAPACITY: parseFloat($('#MAX_CAPACITY').val()),
                    EFFICIENCY: parseFloat($('#EFFICIENCY').val()),
                    MIN_SOC: parseFloat($('#MIN_SOC').val()),
                    MAX_SOC: parseFloat($('#MAX_SOC').val())
                };
                
                // Result naming
                config.RESULT_NAMING = {
                    USE_CUSTOM_ID: $('#USE_CUSTOM_ID').is(':checked'),
                    CUSTOM_ID: $('#CUSTOM_ID').val()
                };
                
                $.ajax({
                    url: url,
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ config: config }),
                    success: function(response) {
                        console.log('Process started:', response);
                        currentProcessId = response.processId;
                        $('#process-title').text(`Process Output (${response.processId})`);
                        $('#process-output').text('Starting process...\n');
                        $('#stopProcess').show();
                    },
                    error: function(error) {
                        console.error('Error starting process:', error);
                        alert('Error starting process: ' + (error.responseJSON?.error || 'Unknown error'));
                    }
                });
            }
        });
    </script>
    
    <style>
        .sidebar {
            background-color: #343a40;
            color: white;
            min-height: 100vh;
            padding-top: 20px;
        }
        
        .sidebar-header {
            padding: 10px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }
        
        .sidebar .nav-link {
            color: rgba(255, 255, 255, 0.75);
            padding: 10px 15px;
        }
        
        .sidebar .nav-link:hover,
        .sidebar .nav-link.active {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .main-content {
            padding: 30px;
            background-color: #f8f9fa;
            min-height: 100vh;
        }
        
        .process-output {
            background-color: #212529;
            color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9rem;
        }
    </style>
</body>
</html>